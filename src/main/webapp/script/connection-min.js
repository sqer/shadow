YAHOO.util.Connect={_msxml_progid:["Microsoft.XMLHTTP","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"],_http_headers:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:"application/x-www-form-urlencoded; charset=UTF-8",_default_form_header:"application/x-www-form-urlencoded",_use_default_xhr_header:true,_default_xhr_header:"XMLHttpRequest",_has_default_headers:true,_isFormSubmit:false,_default_headers:{},_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,startEvent:new YAHOO.util.CustomEvent("start"),completeEvent:new YAHOO.util.CustomEvent("complete"),successEvent:new YAHOO.util.CustomEvent("success"),failureEvent:new YAHOO.util.CustomEvent("failure"),abortEvent:new YAHOO.util.CustomEvent("abort"),_customEvents:{onStart:["startEvent","start"],onComplete:["completeEvent","complete"],onSuccess:["successEvent","success"],onFailure:["failureEvent","failure"],onUpload:["uploadEvent","upload"],onAbort:["abortEvent","abort"]},setProgId:function(b){this._msxml_progid.unshift(b)},setDefaultPostHeader:function(b){if(typeof b=="string"){this._default_post_header=b;this._use_default_post_header=true}else{if(typeof b=="boolean"){this._use_default_post_header=b}}},setDefaultXhrHeader:function(b){if(typeof b=="string"){this._default_xhr_header=b}else{this._use_default_xhr_header=b}},setPollingInterval:function(b){if(typeof b=="number"&&isFinite(b)){this._polling_interval=b}},createXhrObject:function(e){var i,l,k;try{l=new XMLHttpRequest();i={conn:l,tId:e,xhr:true}}catch(j){for(k=0;k<this._msxml_progid.length;++k){try{l=new ActiveXObject(this._msxml_progid[k]);i={conn:l,tId:e,xhr:true};break}catch(h){}}}finally{return i}},getConnectionObject:function(h){var f,e=this._transaction_id;try{if(!h){f=this.createXhrObject(e)}else{f={tId:e};if(h==="xdr"){f.conn=this._transport;f.xdr=true}else{if(h==="upload"){f.upload=true}}}if(f){this._transaction_id++}}catch(g){}return f},asyncRequest:function(l,p,m,k){var j=m&&m.argument?m.argument:null,o=this,n,i;if(this._isFileUpload){i="upload"}else{if(m&&m.xdr){i="xdr"}}n=this.getConnectionObject(i);if(!n){return null}else{if(m&&m.customevents){this.initCustomEvents(n,m)}if(this._isFormSubmit){if(this._isFileUpload){window.setTimeout(function(){o.uploadFile(n,m,p,k)},10);return n}if(l.toUpperCase()=="GET"){if(this._sFormData.length!==0){p+=((p.indexOf("?")==-1)?"?":"&")+this._sFormData}}else{if(l.toUpperCase()=="POST"){k=k?this._sFormData+"&"+k:this._sFormData}}}if(l.toUpperCase()=="GET"&&(m&&m.cache===false)){p+=((p.indexOf("?")==-1)?"?":"&")+"rnd="+new Date().valueOf().toString()}if(this._use_default_xhr_header){if(!this._default_headers["X-Requested-With"]){this.initHeader("X-Requested-With",this._default_xhr_header,true)}}if((l.toUpperCase()==="POST"&&this._use_default_post_header)&&this._isFormSubmit===false){this.initHeader("Content-Type",this._default_post_header)}if(n.xdr){this.xdr(n,l,p,m,k);return n}n.conn.open(l,p,true);if(this._has_default_headers||this._has_http_headers){this.setHeader(n)}this.handleReadyState(n,m);n.conn.send(k||"");if(this._isFormSubmit===true){this.resetFormState()}this.startEvent.fire(n,j);if(n.startEvent){n.startEvent.fire(n,j)}return n}},initCustomEvents:function(f,d){var e;for(e in d.customevents){if(this._customEvents[e][0]){f[this._customEvents[e][0]]=new YAHOO.util.CustomEvent(this._customEvents[e][1],(d.scope)?d.scope:null);f[this._customEvents[e][0]].subscribe(d.customevents[e])}}},handleReadyState:function(f,e){var g=this,h=(e&&e.argument)?e.argument:null;if(e&&e.timeout){this._timeOut[f.tId]=window.setTimeout(function(){g.abort(f,e,true)},e.timeout)}this._poll[f.tId]=window.setInterval(function(){if(f.conn&&f.conn.readyState===4){window.clearInterval(g._poll[f.tId]);delete g._poll[f.tId];if(e&&e.timeout){window.clearTimeout(g._timeOut[f.tId]);delete g._timeOut[f.tId]}g.completeEvent.fire(f,h);if(f.completeEvent){f.completeEvent.fire(f,h)}g.handleTransactionResponse(f,e)}},this._polling_interval)},handleTransactionResponse:function(s,l,q){var p,t,n=(l&&l.argument)?l.argument:null,r=(s.r&&s.r.statusText==="xdr:success")?true:false,m=(s.r&&s.r.statusText==="xdr:failure")?true:false,e=q;try{if((s.conn.status!==undefined&&s.conn.status!==0)||r){p=s.conn.status}else{if(m&&!e){p=0}else{p=13030}}}catch(o){p=13030}if((p>=200&&p<300)||p===1223||r){t=s.xdr?s.r:this.createResponseObject(s,n);if(l&&l.success){if(!l.scope){l.success(t)}else{l.success.apply(l.scope,[t])}}this.successEvent.fire(t);if(s.successEvent){s.successEvent.fire(t)}}else{switch(p){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:t=this.createExceptionObject(s.tId,n,(q?q:false));if(l&&l.failure){if(!l.scope){l.failure(t)}else{l.failure.apply(l.scope,[t])}}break;default:t=(s.xdr)?s.response:this.createResponseObject(s,n);if(l&&l.failure){if(!l.scope){l.failure(t)}else{l.failure.apply(l.scope,[t])}}}this.failureEvent.fire(t);if(s.failureEvent){s.failureEvent.fire(t)}}this.releaseObject(s);t=null},createResponseObject:function(r,l){var o={},e={},n,p,m,q;try{p=r.conn.getAllResponseHeaders();m=p.split("\n");for(n=0;n<m.length;n++){q=m[n].indexOf(":");if(q!=-1){e[m[n].substring(0,q)]=YAHOO.lang.trim(m[n].substring(q+2))}}}catch(i){}o.tId=r.tId;o.status=(r.conn.status==1223)?204:r.conn.status;o.statusText=(r.conn.status==1223)?"No Content":r.conn.statusText;o.getResponseHeader=e;o.getAllResponseHeaders=p;o.responseText=r.conn.responseText;o.responseXML=r.conn.responseXML;if(l){o.argument=l}return o},createExceptionObject:function(l,p,k){var n=0,m="communication failure",i=-1,j="transaction aborted",o={};o.tId=l;if(k){o.status=i;o.statusText=j}else{o.status=n;o.statusText=m}if(p){o.argument=p}return o},initHeader:function(h,e,f){var g=(f)?this._default_headers:this._http_headers;g[h]=e;if(f){this._has_default_headers=true}else{this._has_http_headers=true}},setHeader:function(d){var c;if(this._has_default_headers){for(c in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,c)){d.conn.setRequestHeader(c,this._default_headers[c])}}}if(this._has_http_headers){for(c in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,c)){d.conn.setRequestHeader(c,this._http_headers[c])}}this._http_headers={};this._has_http_headers=false}},resetDefaultHeaders:function(){this._default_headers={};this._has_default_headers=false},abort:function(m,k,j){var n,i=(k&&k.argument)?k.argument:null;m=m||{};if(m.conn){if(m.xhr){if(this.isCallInProgress(m)){m.conn.abort();window.clearInterval(this._poll[m.tId]);delete this._poll[m.tId];if(j){window.clearTimeout(this._timeOut[m.tId]);delete this._timeOut[m.tId]}n=true}}else{if(m.xdr){m.conn.abort(m.tId);n=true}}}else{if(m.upload){var h="yuiIO"+m.tId;var l=document.getElementById(h);if(l){YAHOO.util.Event.removeListener(l,"load");document.body.removeChild(l);if(j){window.clearTimeout(this._timeOut[m.tId]);delete this._timeOut[m.tId]}n=true}}else{n=false}}if(n===true){this.abortEvent.fire(m,i);if(m.abortEvent){m.abortEvent.fire(m,i)}this.handleTransactionResponse(m,k,true)}return n},isCallInProgress:function(b){b=b||{};if(b.xhr&&b.conn){return b.conn.readyState!==4&&b.conn.readyState!==0}else{if(b.xdr&&b.conn){return b.conn.isCallInProgress(b.tId)}else{if(b.upload===true){return document.getElementById("yuiIO"+b.tId)?true:false}else{return false}}}},releaseObject:function(b){if(b&&b.conn){b.conn=null;b=null}}};(function(){var m=YAHOO.util.Connect,l={};function p(b){var a='<object id="YUIConnectionSwf" type="application/x-shockwave-flash" data="'+b+'" width="0" height="0"><param name="movie" value="'+b+'"><param name="allowScriptAccess" value="always"></object>',c=document.createElement("div");document.body.appendChild(c);c.innerHTML=a}function j(a,d,c,e,b){l[parseInt(a.tId)]={o:a,c:e};if(b){e.method=d;e.data=b}a.conn.send(c,e,a.tId)}function o(a){p(a);m._transport=document.getElementById("YUIConnectionSwf")}function i(){m.xdrReadyEvent.fire()}function k(a,b){if(a){m.startEvent.fire(a,b.argument);if(a.startEvent){a.startEvent.fire(a,b.argument)}}}function n(a){var c=l[a.tId].o,b=l[a.tId].c;if(a.statusText==="xdr:start"){k(c,b);return}a.responseText=decodeURI(a.responseText);c.r=a;if(b.argument){c.r.argument=b.argument}this.handleTransactionResponse(c,b,a.statusText==="xdr:abort"?true:false);delete l[a.tId]}m.xdr=j;m.swf=p;m.transport=o;m.xdrReadyEvent=new YAHOO.util.CustomEvent("xdrReady");m.xdrReady=i;m.handleXdrResponse=n})();(function(){var o=YAHOO.util.Connect,m=YAHOO.util.Event,k=document.documentMode?document.documentMode:false;o._isFileUpload=false;o._formNode=null;o._sFormData=null;o._submitElementValue=null;o.uploadEvent=new YAHOO.util.CustomEvent("upload");o._hasSubmitListener=function(){if(m){m.addListener(document,"click",function(c){var a=m.getTarget(c),b=a.nodeName.toLowerCase();if((b==="input"||b==="button")&&(a.type&&a.type.toLowerCase()=="submit")){o._submitElementValue=encodeURIComponent(a.name)+"="+encodeURIComponent(a.value)}});return true}return false}();function l(f,c,F){var a,y,b,h,B,g=false,z=[],D=0,C,d,E,e,A;this.resetFormState();if(typeof f=="string"){a=(document.getElementById(f)||document.forms[f])}else{if(typeof f=="object"){a=f}else{return}}if(c){this.createFrame(F?F:null);this._isFormSubmit=true;this._isFileUpload=true;this._formNode=a;return}for(C=0,d=a.elements.length;C<d;++C){y=a.elements[C];B=y.disabled;b=y.name;if(!B&&b){b=encodeURIComponent(b)+"=";h=encodeURIComponent(y.value);switch(y.type){case"select-one":if(y.selectedIndex>-1){A=y.options[y.selectedIndex];z[D++]=b+encodeURIComponent((A.attributes.value&&A.attributes.value.specified)?A.value:A.text)}break;case"select-multiple":if(y.selectedIndex>-1){for(E=y.selectedIndex,e=y.options.length;E<e;++E){A=y.options[E];if(A.selected){z[D++]=b+encodeURIComponent((A.attributes.value&&A.attributes.value.specified)?A.value:A.text)}}}break;case"radio":case"checkbox":if(y.checked){z[D++]=b+h}break;case"file":case undefined:case"reset":case"button":break;case"submit":if(g===false){if(this._hasSubmitListener&&this._submitElementValue){z[D++]=this._submitElementValue}g=true}break;default:z[D++]=b+h}}}this._isFormSubmit=true;this._sFormData=z.join("&");this.initHeader("Content-Type",this._default_form_header);return this._sFormData}function p(){this._isFormSubmit=false;this._isFileUpload=false;this._formNode=null;this._sFormData=""}function i(b){var a="yuiIO"+this._transaction_id,c=(k===9)?true:false,d;if(YAHOO.env.ua.ie&&!c){d=document.createElement('<iframe id="'+a+'" name="'+a+'" />');if(typeof b=="boolean"){d.src="javascript:false"}}else{d=document.createElement("iframe");d.id=a;d.name=a}d.style.position="absolute";d.style.top="-1000px";d.style.left="-1000px";document.body.appendChild(d)}function n(d){var a=[],c=d.split("&"),b,e;for(b=0;b<c.length;b++){e=c[b].indexOf("=");if(e!=-1){a[b]=document.createElement("input");a[b].type="hidden";a[b].name=decodeURIComponent(c[b].substring(0,e));a[b].value=decodeURIComponent(c[b].substring(e+1));this._formNode.appendChild(a[b])}}return a}function j(E,D,B,F){var g="yuiIO"+E.tId,b="multipart/form-data",f=document.getElementById(g),z=(k>=8)?true:false,C=this,a=(D&&D.argument)?D.argument:null,e,h,y,c,A,d;A={action:this._formNode.getAttribute("action"),method:this._formNode.getAttribute("method"),target:this._formNode.getAttribute("target")};this._formNode.setAttribute("action",B);this._formNode.setAttribute("method","POST");this._formNode.setAttribute("target",g);if(YAHOO.env.ua.ie&&!z){this._formNode.setAttribute("encoding",b)}else{this._formNode.setAttribute("enctype",b)}if(F){e=this.appendPostData(F)}this._formNode.submit();this.startEvent.fire(E,a);if(E.startEvent){E.startEvent.fire(E,a)}if(D&&D.timeout){this._timeOut[E.tId]=window.setTimeout(function(){C.abort(E,D,true)},D.timeout)}if(e&&e.length>0){for(h=0;h<e.length;h++){this._formNode.removeChild(e[h])}}for(y in A){if(YAHOO.lang.hasOwnProperty(A,y)){if(A[y]){this._formNode.setAttribute(y,A[y])}else{this._formNode.removeAttribute(y)}}}this.resetFormState();d=function(){var t,s,r;if(D&&D.timeout){window.clearTimeout(C._timeOut[E.tId]);delete C._timeOut[E.tId]}C.completeEvent.fire(E,a);if(E.completeEvent){E.completeEvent.fire(E,a)}c={tId:E.tId,argument:a};try{t=f.contentWindow.document.getElementsByTagName("body")[0];s=f.contentWindow.document.getElementsByTagName("pre")[0];if(t){if(s){r=s.textContent?s.textContent:s.innerText}else{r=t.textContent?t.textContent:t.innerText}}c.responseText=r;c.responseXML=f.contentWindow.document.XMLDocument?f.contentWindow.document.XMLDocument:f.contentWindow.document}catch(q){}if(D&&D.upload){if(!D.scope){D.upload(c)}else{D.upload.apply(D.scope,[c])}}C.uploadEvent.fire(c);if(E.uploadEvent){E.uploadEvent.fire(c)}m.removeListener(f,"load",d);setTimeout(function(){document.body.removeChild(f);C.releaseObject(E)},100)};m.addListener(f,"load",d)}o.setForm=l;o.resetFormState=p;o.createFrame=i;o.appendPostData=n;o.uploadFile=j})();YAHOO.register("connection",YAHOO.util.Connect,{version:"2.9.0",build:"2800"});